# Single-cell multiQC report

## Outlier definitions

### Mitochondrial, Ribosomal, Hemoglobin, UMI and Genes Outliers
$$
\left| \text{pct\_counts\_x} - \mathrm{median}(\text{pct\_counts\_x}) \right| 
> X \cdot \mathrm{MAD}(\text{pct\_counts\_x}), 
\quad x \in \{\text{mito}, \text{ribo}, \text{hb}\}
$$

where $X = \texttt{--nmads}$ (default $X=5$).

---

### Counts Outliers

$$
\left| \ln(\text{genes} + 1) - \widehat{\ln(\text{genes}+1)} \right|
> X \cdot \mathrm{MAD}\!\left( \ln(\text{genes}+1) - \widehat{\ln(\text{genes}+1)} \right)
$$

where the fitted values $\widehat{\ln(\text{genes}+1)}$ come from the linear model

$$
\ln(\text{genes} + 1) \sim \ln(\text{counts} + 1).
$$


## Doublets
Doublets are predicted with [Scanpy implementation of Scrublet algorithm](https://scanpy.readthedocs.io/en/stable/api/generated/scanpy.pp.scrublet.html) [Wolock et al., 2019](https://scanpy.readthedocs.io/en/stable/references.html#id75)

## Examples

### PTSDBrainomics
Example of a "high performing" dataset, where author's "ground truth" cell type labels were shown to largely agree with predicted cell type labels.


A [Benchmarking multiQC report](./PTSDBrainomics_scvi_whole_cortex_multiqc.html) was generated from https://github.com/rachadele/nextflow_eval_pipeline.
This is not to be confused with the multiQC report generated by the re-annotation pipeline, which is agnostic to "ground truth" labels as they are not provided by authors for the majority of datasets.

